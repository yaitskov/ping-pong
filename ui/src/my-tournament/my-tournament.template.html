<main-menu></main-menu>
<request-status></request-status>
<div class="container my-tournament-admin">
  <div class="form-group">
    <div class="btn-group">
      <a class="btn btn-success"
         ng-click="$ctrl.open()"
         ng-show="$ctrl.isDrafting()"
         title="Split participants into groups and open tournament">
        <span class="glyphicon glyphicon-play-circle"></span>
      </a>
      <a class="btn btn-primary"
         href="#!/my/matches/judgement"
         ng-show="$ctrl.tournament.state == 'Open'"
         title="Judge and score open matches in the tournament">
        <img src="/img/whistle.png" class="icon-image"/>
      </a>
      <a class="btn btn-primary"
         href="#!/tournament/result/{{$ctrl.tournament.tid}}"
         ng-show="$ctrl.tournament.state == 'Close'"
         title="Browser tournament results">
        <span class="glyphicon glyphicon-eye-open"></span>
      </a>
      <a class="btn btn-default"
         title="Previous Tournament in the seria"
         href="#!/my/tournament/{{$ctrl.tournament.previousTid}}"
         ng-show="$ctrl.tournament.previousTid">
        <span class="glyphicon glyphicon-circle-arrow-left"></span>
      </a>
      <a class="btn btn-default"
         title="Edit tournament"
         ng-show="$ctrl.canEdit()"
         href="#!/my/tournament/edit/{{$ctrl.tournament.tid}}">
        <span class="glyphicon glyphicon-edit"></span>
      </a>
      <a class="btn btn-default"
         title="Configure tournament parameters"
         ng-show="$ctrl.canConfigureParams()"
         href="#!/my/tournament/parameters/{{$ctrl.tournament.tid}}">
        <span class="glyphicon glyphicon-cog"></span>
      </a>
      <a class="btn btn-danger"
         ng-click="$ctrl.cancel()"
         ng-show="$ctrl.isNotCanceled()"
         title="Stop and cancel tournament">
        <span class="glyphicon glyphicon-stop"></span>
      </a>
      <a class="btn btn-primary"
         title="Announce and Open Draft"
         ng-click="$ctrl.beginDrafting()"
         ng-show="$ctrl.canBeginDrafting()">
        <span class="glyphicon glyphicon-globe"></span>
      </a>
      <a class="btn btn-primary"
         title="Restart canceled tournament from scratch"
         ng-click="$ctrl.restart()"
         ng-show="$ctrl.tournament.state == 'Canceled'">
        <span class="glyphicon glyphicon-repeat"></span>
      </a>
      <a class="btn btn-primary"
         title="Add offline participant, who does not have internet and a good phone"
         href="#!/tournament/enlist/offline/{{$ctrl.tournament.tid}}"
         ng-show="$ctrl.tournament.state == 'Draft'">
        <span class="glyphicon glyphicon-plus-sign"></span>
      </a>
    </div>
  </div>
  <div ng-show="$ctrl.errorHasUncheckedUsers.length > 0">
    <div class="form-group">
      <div class="alert alert-danger">
        Tournament has {{$ctrl.errorHasUncheckedUsers.length}}
        enlisted, but unchecked participants. To begin the tournament
        you need to expel all of them or mark as participanting.
      </div>
    </div>
    <div class="form-group">
      <a class="btn btn-danger" ng-click="$ctrl.expelAndOpenTournament()">
        Expel listed below &amp; open
      </a>
      <a class="btn btn-default" ng-click="$ctrl.cancelExpelAll()">
        Cancel
      </a>
    </div>
    <div class="form-group">
      <table class="table table-bordered">
        <tr ng-repeat="participant in $ctrl.errorHasUncheckedUsers | orderBy : 'name'">
          <td>
            <a href="#!/my/tournament/{{$ctrl.tournament.tid}}/participant/{{participant.uid}}">
              {{participant.name}}
            </a>
          </td>
        </tr>
      </table>
    </div>
  </div>
  <div class="form-group" ng-show="$ctrl.wantRemove">
    <div class="alert alert-danger">
      Confirm that you want to terminate/cancel tournament. You can
      reopen tournament later, but players should replay matches from
      the begginning.
    </div>
  </div>
  <div class="form-group" ng-show="$ctrl.wantRemove">
    <a class="btn btn-danger" ng-click="$ctrl.confirmCancel()">
      Confirm
    </a>
  </div>
  <div class="form-group">
    <table class="table">
      <tbody>
        <tr>
          <td>Name</td>
          <td>{{$ctrl.tournament.name}}</td>
        </tr>
        <tr>
          <td>State</td>
          <td>{{$ctrl.tournament.state}}</td>
        </tr>
        <tr>
          <td>Place</td>
          <td>
            <a href="#!/place/{{$ctrl.tournament.place.pid}}">
              {{$ctrl.tournament.place.name}}
            </a>
          </td>
        </tr>
        <tr>
          <td>Date</td>
          <td>
            {{$ctrl.tournament.opensAt|date : 'MMM d EEE h a Z' }}
          </td>
        </tr>
        <tr>
          <td>Categories</td>
          <td>
            <a class="btn btn-default"
               href="#!/my/tournament/categories/{{$ctrl.tournament.tid}}">
              {{$ctrl.tournament.categories}}
            </a>
          </td>
        </tr>
        <tr>
          <td>Enlisted</td>
          <td>
            <a class="btn btn-default"
               href="#!/my/tournament/presence/{{$ctrl.tournament.tid}}">
              {{$ctrl.tournament.enlisted}}
            </a>
          </td>
        </tr>
      </tbody>
    </table>
  </div>
</div>
